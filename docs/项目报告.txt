《基于Python的B站高等数学教学资源分析与推荐系统》——开发报告（应用：数学课代表）
1.	项目概述
本项目构建了一个针对“高等数学/考研数学”垂直领域的 B站视频聚合与分析平台。旨在解决B站教育分区内容良莠不齐、筛选成本高昂的痛点。系统通过数据采集、清洗、建模，实现了对 UP 主教学能力的多维量化（硬核指数、五维模型）与内容的智能分类，为用户提供“跳过筛选，直接学习”的一站式解决方案。
1.	核心模块演进
2.1 资源检索库
功能：提供基于“知识点”与“学习阶段”的二级筛选体系。
迭代：从传统的卡片式导航升级为行内胶囊式交互，大幅提升了屏幕信息密度。卡片设计移除冗余边框，采用“封面+关键指标”的极简布局，核心指标“硬核指数”采用品牌色高亮，强化视觉重心。
2.2 学术解剖室
功能：UP 主教学能力的全维对比。
可视化重构：
雷达图方面，引入对数归一化算法，解决头部与腰部 UP 主流量数据量级差异（如百万播放对千次播放）导致的图形压缩问题，确保各层级 UP 主的能力特征均能清晰呈现。
语义词云方面，摒弃低效的圆形布局，改用方形铺满策略，配合 TF-IDF 提取的高权重关键词，消灭容器死角，最大化信息展示效率。
交互优化：移除“人机感”图标，统一使用通用用户标识；下拉框文字强制居中，符合人眼阅读习惯。
2.3 智能推荐引擎
功能：基于场景的个性化推荐。
策略：构建了“期末突击（短时长+高热度）”、“考研基础（长时长+高干货）”、“习题冲刺（特定关键词+高收藏）”三套规则引擎，结合用户历史行为进行加权召回。
1.	关键技术挑战与解决方案
3.1 数据库架构一致性
问题：开发中期物理删除了 coin_count 等非核心字段，导致 ORM 模型与数据库结构不匹配，引发服务崩溃。
解决：实施数据库迁移策略，并重构爬虫层的数据处理流程，建立字段缺失时的统计学拟合模型（基于收藏数与播放量的线性回归估算），保证了前端五维模型数据的连续性与完整性。
3.2 文本分类冷启动
问题：早期仅依赖关键词匹配，导致“线性代数”与“高数”视频频发归类错误。
解决：集成 TF-IDF 特征提取 与 互补朴素贝叶斯分类器。采用“AI 预测为主，规则匹配兜底”的混合策略，将模糊标题的分类准确率从 60% 提升至 86% 以上。
3.3 可视化渲染适配
问题：图表组件在 Flex 布局下初始化高度计算异常，导致词云容器塌陷。
解决：重写前端布局逻辑，强制指定图表容器的 flex-basis 与 min-height 属性；并在数据加载回调中引入 resize 重绘钩子，确保 DOM 渲染完成后的像素级对齐。
1.	数据工程
采集层：设计了包含“名师矩阵”、“核心痛点”双维度的关键词表，通过 requests.Session 复用连接与重试机制，解决了高频采集下的连接重置问题。
清洗层：实现了基于 BV 号的去重逻辑与 Jieba 分词停用词过滤，确保入库数据的纯净度。
1.	总结
本项目成功从单一的基础增删改查原型，进化为集成了爬虫工程、机器学习分类与高级数据可视化的现代化 Web 应用。通过解决跨域防盗链、数据归一化与语义分类等技术难题，构建了一个高可用、高价值的垂直领域视频分析系统。

2.4 用户行为闭环与个人中心
功能：登录注册 + 个人资料维护（用户名/签名/头像），头像上传会校验格式、MIME、大小后统一转为 256px JPEG。
行为数据：收藏/待看/历史三类动作统一落库（唯一键避免重复），通过 `/go/<bvid>` 与 `/api/log_history` 自动记录观看足迹；待看支持完成/未完成切换，历史仅返回最近 200 条确保性能。
曝光：个人中心接口汇总收藏、待看、历史与待办统计，缺失视频返回占位信息，避免前端空列表。

3.4 安全与健壮性
认证：使用 PBKDF2 哈希，旧明文密码自动升级；用户名去重校验与数据库异常回滚。
输入校验：头像 MIME/类型/大小/解码校验；收藏/待看/历史操作限定白名单，缺失参数直接拒绝。
数据一致性：ORM 模型唯一约束防止重复写入；`db.create_all()` 在开发态兜底缺表；主要页面均需登录态。
防崩溃措施：爬虫支持进度回调、重试与中断，异常写入任务日志；词云/雷达的空数据均有默认占位。

4. 数据工程（补充）
采集执行：`/spider` 页面可一键启动后台线程任务，轮询进度/日志并支持取消；`crawl()` 复用 Session+Retry 并随机限速，批量 UPSERT 确保幂等。
配置与分类：内置分层关键词矩阵，优先使用 ML 预测（置信度<0.6 回退规则），写入 phase/subject/category 兼容旧字段。
模型训练：`train_model.py` 从数据库拉取标注样本，jieba 切词 → TF-IDF → ComplementNB，过滤小样本类并输出 `classification_report`，训练后落地 `subject_classifier.pkl` 供爬虫热加载。

5. 部署与运行补充
静态资源：`force_fix.py` 可从 npm 镜像离线拉取 ECharts/WordCloud；前端依赖均在 `static/` 内，弱网环境可本地刷新。
运行流程：推荐虚拟环境 + 本地 MySQL，`flask --app app run` 自动建表；可选先跑爬虫灌库/训练模型，再体验仪表盘、筛选、对比、推荐、个人中心全链路。
